@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    color-scheme: dark;
    --font-display: "Iowan Old Style", "Palatino Linotype", "Book Antiqua", Palatino, "Times New Roman", serif;
    --font-mono:
      "SF Mono",
      "Menlo",
      "Monaco",
      "Cascadia Mono",
      "Segoe UI Mono",
      "Roboto Mono",
      "Oxygen Mono",
      "Ubuntu Monospace",
      "Source Code Pro",
      monospace;
  }

  html {
    background-color: #0d0e10;
    width: 100%;
    font-size: 16.5px;
    overflow-x: hidden;
    padding-top: 0;
    padding-bottom: 0;
  }

  body {
    @apply bg-codex-bg text-white/90 font-body antialiased;
    min-height: 100vh;
    min-height: 100dvh;
    width: 100%;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
    overscroll-behavior-y: none;
    background-color: #0d0e10;
  }

  button,
  a,
  summary,
  select,
  textarea,
  [role="button"] {
    transition:
      background-color 160ms ease,
      border-color 160ms ease,
      color 160ms ease,
      box-shadow 160ms ease,
      transform 160ms ease;
  }

  button,
  a,
  summary,
  select,
  [role="button"] {
    cursor: pointer;
  }

  button:disabled,
  select:disabled {
    cursor: not-allowed;
  }

  summary {
    list-style: none;
  }

  summary::-webkit-details-marker {
    display: none;
  }
}

@media (orientation: portrait) {
  html {
    padding-right: env(safe-area-inset-right);
    padding-left: env(safe-area-inset-left);
  }
}

@media all and (display-mode: standalone) {
  body {
    padding-top: 0;
  }

  html {
    padding: 0;
  }
}

@layer components {
  .sidebar-gradient {
    background:
      radial-gradient(circle at top, rgba(90, 90, 90, 0.4), transparent 50%),
      linear-gradient(180deg, #191a1c 0%, #101112 100%);
    backdrop-filter: blur(16px);
  }

  .main-surface {
    background:
      radial-gradient(circle at 20% 15%, rgba(255, 255, 255, 0.03), transparent 52%),
      radial-gradient(circle at 85% 85%, rgba(255, 255, 255, 0.02), transparent 55%),
      linear-gradient(180deg, rgba(14, 15, 17, 0.96) 0%, rgba(12, 13, 15, 0.98) 100%);
  }

  .conversation-scroll {
    padding-bottom: 24px;
    scroll-padding-bottom: 24px;
  }

  .text-safe-wrap {
    overflow-wrap: anywhere;
    word-break: break-word;
  }

  .text-safe-wrap pre,
  .text-safe-wrap code {
    max-width: 100%;
    overflow-wrap: anywhere;
    word-break: break-word;
    white-space: pre-wrap;
  }

  .lets-build-stage {
    animation: lets-build-rise 520ms cubic-bezier(0.16, 1, 0.3, 1);
  }

  .lets-build-title {
    opacity: 0;
    animation: lets-build-item 440ms cubic-bezier(0.22, 1, 0.36, 1) both;
    animation-delay: 70ms;
  }

  .lets-build-switcher-shell {
    width: 100%;
    display: flex;
    justify-content: center;
    opacity: 0;
    animation: lets-build-item 460ms cubic-bezier(0.22, 1, 0.36, 1) both;
    animation-delay: 150ms;
  }

  .lets-build-subcopy {
    opacity: 0;
    animation: lets-build-item 480ms cubic-bezier(0.22, 1, 0.36, 1) both;
    animation-delay: 240ms;
  }

  .project-label-skeleton {
    position: relative;
    height: 2rem;
    width: min(240px, 68vw);
    overflow: hidden;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.12);
    background: rgba(255, 255, 255, 0.07);
  }

  .project-label-skeleton::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(
      110deg,
      transparent 22%,
      rgba(255, 255, 255, 0.35) 48%,
      transparent 72%
    );
    transform: translateX(-130%);
    animation: soft-shimmer 1.65s linear infinite;
  }

  .project-discovery-panel {
    position: relative;
    margin-top: 0.9rem;
    width: min(320px, 100%);
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.17);
    border-radius: 16px;
    padding: 0.75rem 0.875rem 0.85rem;
    background:
      linear-gradient(140deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.015)),
      rgba(7, 8, 9, 0.42);
    backdrop-filter: blur(11px);
    animation: project-discovery-fade 420ms cubic-bezier(0.16, 1, 0.3, 1);
  }

  .project-discovery-panel::before {
    content: "";
    position: absolute;
    inset: -55% -45%;
    background: linear-gradient(
      120deg,
      transparent 22%,
      rgba(255, 255, 255, 0.16) 50%,
      transparent 78%
    );
    transform: translateX(-76%) rotate(6deg);
    animation: project-discovery-sweep 2.9s linear infinite;
    pointer-events: none;
  }

  .project-discovery-label {
    position: relative;
    z-index: 1;
    font-family: var(--font-mono);
    font-size: 0.68rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: rgba(255, 255, 255, 0.7);
  }

  .project-discovery-track {
    position: relative;
    z-index: 1;
    margin-top: 0.58rem;
    height: 4px;
    width: 100%;
    overflow: hidden;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.12);
  }

  .project-discovery-track::after {
    content: "";
    position: absolute;
    inset: 0;
    width: 100%;
    border-radius: inherit;
    transform-origin: left center;
    transform: scaleX(0);
    background: linear-gradient(90deg, rgba(255, 255, 255, 0.22), rgba(255, 255, 255, 0.88), rgba(255, 255, 255, 0.28));
    animation: project-discovery-track 1.2s cubic-bezier(0.22, 1, 0.36, 1) forwards;
  }

  .project-discovery-dots {
    position: relative;
    z-index: 1;
    margin-top: 0.52rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.35rem;
  }

  .project-discovery-dot {
    height: 4px;
    width: 4px;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.55);
    animation: project-discovery-dot 1.12s ease-in-out infinite;
  }

  .project-discovery-dot:nth-child(2) {
    animation-delay: 120ms;
  }

  .project-discovery-dot:nth-child(3) {
    animation-delay: 240ms;
  }

  .thread-skeleton-stack {
    margin-top: 0.1rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .thread-skeleton-row {
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 12px;
    padding: 0.48rem 0.5rem;
    background: linear-gradient(140deg, rgba(255, 255, 255, 0.035), rgba(255, 255, 255, 0.012));
    opacity: 0;
    animation: thread-skeleton-rise 460ms cubic-bezier(0.2, 1, 0.3, 1) both;
  }

  .thread-skeleton-header {
    display: flex;
    align-items: center;
    gap: 0.4rem;
  }

  .thread-skeleton-dot {
    width: 7px;
    height: 7px;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.28);
    box-shadow: 0 0 9px rgba(255, 255, 255, 0.12);
  }

  .thread-skeleton-line {
    position: relative;
    display: block;
    overflow: hidden;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.1);
  }

  .thread-skeleton-line::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(105deg, transparent 25%, rgba(255, 255, 255, 0.3) 50%, transparent 75%);
    transform: translateX(-130%);
    animation: soft-shimmer 1.7s linear infinite;
  }

  .thread-skeleton-line-title {
    height: 8px;
    width: 56%;
  }

  .thread-skeleton-line-count {
    margin-left: auto;
    height: 8px;
    width: 18%;
  }

  .thread-skeleton-line-item {
    margin-top: 0.45rem;
    height: 7px;
    width: 87%;
  }

  .thread-skeleton-line-item.short {
    margin-top: 0.32rem;
    width: 62%;
  }

  .project-group-reveal {
    opacity: 0;
    animation: project-group-enter 420ms cubic-bezier(0.2, 1, 0.3, 1) both;
  }


  .thinking-sweep {
    position: relative;
    display: inline-block;
    font-family: var(--font-mono);
    font-size: 11px;
    font-weight: 550;
    letter-spacing: 0.12em;
    text-transform: none;
    color: rgba(255, 255, 255, 0.7);
    animation: thinking-pulse 1.8s ease-in-out infinite;
  }

  .prose-inherit {
    --tw-prose-body: currentColor;
    --tw-prose-headings: currentColor;
    --tw-prose-lead: currentColor;
    --tw-prose-links: currentColor;
    --tw-prose-bold: currentColor;
    --tw-prose-counters: currentColor;
    --tw-prose-bullets: currentColor;
    --tw-prose-quotes: currentColor;
  }

  .prose-inherit :where(code):not(:where([class~="not-prose"] *)) {
    color: currentColor;
  }
}

@keyframes thinking-pulse {
  0%,
  100% {
    opacity: 0.45;
    text-shadow: 0 0 0 rgba(255, 255, 255, 0);
  }
  50% {
    opacity: 1;
    text-shadow: 0 0 8px rgba(255, 255, 255, 0.35);
  }
}

@keyframes lets-build-rise {
  0% {
    opacity: 0;
    transform: translateY(16px) scale(0.985);
    filter: blur(4px);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
    filter: blur(0);
  }
}

@keyframes lets-build-item {
  0% {
    opacity: 0;
    transform: translateY(8px);
    filter: blur(3px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
    filter: blur(0);
  }
}

@keyframes project-discovery-fade {
  0% {
    opacity: 0;
    transform: translateY(8px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes project-discovery-sweep {
  0% {
    transform: translateX(-76%) rotate(6deg);
  }
  100% {
    transform: translateX(86%) rotate(6deg);
  }
}

@keyframes project-discovery-track {
  0% {
    opacity: 0.45;
    transform: scaleX(0.02);
  }
  100% {
    opacity: 1;
    transform: scaleX(1);
  }
}

@keyframes project-discovery-dot {
  0%,
  100% {
    opacity: 0.35;
    transform: translateY(0) scale(0.9);
  }
  50% {
    opacity: 1;
    transform: translateY(-1px) scale(1.1);
  }
}

@keyframes soft-shimmer {
  0% {
    transform: translateX(-130%);
  }
  100% {
    transform: translateX(180%);
  }
}

@keyframes thread-skeleton-rise {
  0% {
    opacity: 0;
    transform: translateY(6px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes project-group-enter {
  0% {
    opacity: 0;
    transform: translateY(7px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (prefers-reduced-motion: reduce) {
  .lets-build-stage,
  .lets-build-title,
  .lets-build-switcher-shell,
  .lets-build-subcopy,
  .project-discovery-panel,
  .project-discovery-panel::before,
  .project-discovery-track::after,
  .project-discovery-dot,
  .project-label-skeleton::after,
  .thread-skeleton-row,
  .thread-skeleton-line::after,
  .project-group-reveal,
  .thinking-sweep {
    animation: none !important;
    filter: none !important;
    transform: none !important;
  }
}
